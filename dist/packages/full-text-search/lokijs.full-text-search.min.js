(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==="object"&&typeof module==="object")module.exports=factory();else if(typeof define==="function"&&define.amd)define([],factory);else if(typeof exports==="object")exports["@lokijs/full-text-search"]=factory();else{root["@lokijs/full-text-search"]=factory();root["LokiFullTextSearch"]=root["@lokijs/full-text-search"].default}})(this,function(){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{configurable:false,enumerable:true,get:getter})}};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=4)}([function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["b"]=toCodePoints;var __WEBPACK_IMPORTED_MODULE_0__tokenizer__=__webpack_require__(1);function toCodePoints(str){const r=[];for(let i=0;i<str.length;){const chr=str.charCodeAt(i++);if(chr>=55296&&chr<=56319){const low=str.charCodeAt(i++);r.push(65536+(chr-55296<<10)|low-56320)}else{r.push(chr)}}return r}class InvertedIndex{constructor(options={}){this._docCount=0;this._docStore={};this._totalFieldLength=0;this._root=new Map;({store:this._store=true,optimizeChanges:this._optimizeChanges=true,tokenizer:this._tokenizer=new __WEBPACK_IMPORTED_MODULE_0__tokenizer__["a"]}=options)}get store(){return this._store}set store(val){this._store=val}get tokenizer(){return this._tokenizer}get documentCount(){return this._docCount}get documentStore(){return this._docStore}get totalFieldLength(){return this._totalFieldLength}get root(){return this._root}insert(field,docId){if(this._docStore[docId]!==undefined){throw Error("Field already added.")}this._docCount+=1;this._docStore[docId]={};const fieldTokens=this._tokenizer.tokenize(field);this._totalFieldLength+=fieldTokens.length;const termRefs=[];this._docStore[docId]={fieldLength:fieldTokens.length};if(this._optimizeChanges){Object.defineProperties(this._docStore[docId],{termRefs:{enumerable:false,configurable:true,writable:true,value:termRefs}})}for(const token of new Set(fieldTokens)){if(token===""){continue}let tf=0;for(let j=0;j<fieldTokens.length;j++){if(fieldTokens[j]===token){++tf}}let branch=this._root;for(const c of toCodePoints(token)){let child=branch.get(c);if(child===undefined){child=new Map;if(this._optimizeChanges){Object.defineProperties(child,{pa:{enumerable:false,configurable:true,writable:true,value:branch}})}branch.set(c,child)}branch=child}if(branch.dc===undefined){branch.dc={};branch.df=0}branch.dc[docId]=tf;branch.df+=1;termRefs.push(branch)}}remove(docId){if(this._docStore[docId]===undefined){return}const docStore=this._docStore[docId];delete this._docStore[docId];this._docCount-=1;this._totalFieldLength-=docStore.fieldLength;if(this._optimizeChanges){const termRefs=docStore.termRefs;for(let j=0;j<termRefs.length;j++){let index=termRefs[j];index.df-=1;delete index.dc[docId];if(index.df===0){delete index.df;delete index.dc;if(index.size!==0){continue}do{const parent=index.pa;delete index.pa;for(const key of parent.keys()){if(parent.get(key)===index){parent.delete(key);break}}index=parent}while(index.pa!==undefined&&index.size===0&&index.df===undefined)}}}else{const recursive=root=>{for(const child of root){if(recursive(child[1])){root.delete(child[0])}}if(root.df!==undefined){if(root.dc[docId]!==undefined){root.df-=1;delete root.dc[docId];if(root.df===0){delete root.df;delete root.dc}}}return root.size===0&&root.dc===undefined};recursive(this._root)}}static getTermIndex(term,root,start=0){if(start>=term.length){return null}for(let i=start;i<term.length;i++){let child=root.get(term[i]);if(child===undefined){return null}root=child}return root}static extendTermIndex(root){const termIndices=[];const rec=(idx,r)=>{if(idx.df!==undefined){termIndices.push({index:idx,term:r.slice()})}r.push(0);for(const child of idx){r[r.length-1]=child[0];rec(child[1],r)}r.pop()};rec(root,[]);return termIndices}static serializeIndex(index){const rec=idx=>{let k=[];let v=[];let r={df:idx.df,dc:idx.dc};if(idx.size===0){return[k,v,r]}for(const child of idx){k.push(child[0]);v.push(rec(child[1]))}return[k,v,r]};return rec(index)}static deserializeIndex(ar){const rec=arr=>{let idx=new Map;for(let i=0;i<arr[0].length;i++){idx.set(arr[0][i],rec(arr[1][i]))}if(arr[2].df!==undefined){idx.df=arr[2].df;idx.dc=arr[2].dc}return idx};return rec(ar)}toJSON(){if(this._store){return{_store:true,_optimizeChanges:this._optimizeChanges,_tokenizer:this._tokenizer,_docCount:this._docCount,_docStore:this._docStore,_totalFieldLength:this._totalFieldLength,_root:InvertedIndex.serializeIndex(this._root)}}return{_store:false,_optimizeChanges:this._optimizeChanges,_tokenizer:this._tokenizer}}static fromJSONObject(serialized,funcTok=undefined){const invIdx=new InvertedIndex({store:serialized._store,optimizeChanges:serialized._optimizeChanges,tokenizer:__WEBPACK_IMPORTED_MODULE_0__tokenizer__["a"].fromJSONObject(serialized._tokenizer,funcTok)});if(invIdx._store){invIdx._docCount=serialized._docCount;invIdx._docStore=serialized._docStore;invIdx._totalFieldLength=serialized._totalFieldLength;invIdx._root=InvertedIndex.deserializeIndex(serialized._root)}const regenerate=(index,parent)=>{if(parent!==null){Object.defineProperties(index,{pa:{enumerable:false,configurable:true,writable:false,value:parent}})}for(const child of index.values()){regenerate(child,index)}if(index.dc!==undefined){const docIds=Object.keys(index.dc);for(let j=0;j<docIds.length;j++){const ref=invIdx._docStore[docIds[j]];if(ref.termRefs===undefined){Object.defineProperties(ref,{termRefs:{enumerable:false,configurable:true,writable:true,value:[]}})}ref.termRefs.push(index)}}};if(invIdx._optimizeChanges){regenerate(invIdx._root,null)}return invIdx}}__webpack_exports__["a"]=InvertedIndex},function(module,__webpack_exports__,__webpack_require__){"use strict";function defaultSplitter(str){let tokens=str.split(/[^\w]+/);for(let i=0;i<tokens.length;i++){tokens[i]=tokens[i].toLowerCase()}return tokens}class Tokenizer{constructor(){this._queue=[];this._symbol=Symbol("label");this.reset()}setSplitter(label,func){if(label===""){throw Error("Label cannot be empty.")}func[this._symbol]=label;this._splitter=func}getSplitter(){return[this._splitter[this._symbol],this._splitter]}resetSplitter(){this._splitter=defaultSplitter}has(labelFunc){return this._getPosition(labelFunc)!==-1}get(labelFunc){let pos=this._getPosition(labelFunc);if(pos===-1){throw Error("Cannot find existing function.")}return[this._queue[pos][this._symbol],this._queue[pos]]}add(label,func){this._addFunction(label,func,this._queue.length)}addBefore(labelFunc,label,func){let pos=this._getPosition(labelFunc);if(pos===-1){throw Error("Cannot find existing function.")}this._addFunction(label,func,pos)}addAfter(labelFunc,label,func){let pos=this._getPosition(labelFunc);if(pos===-1){throw Error("Cannot find existing function.")}this._addFunction(label,func,pos+1)}remove(labelFunc){let pos=this._getPosition(labelFunc);if(pos===-1){throw Error("Cannot find existing function.")}this._queue.splice(pos,1)}reset(){this._splitter=defaultSplitter;this._queue=[]}tokenize(str){let tokens=this._splitter(str);for(let i=0;i<this._queue.length;i++){let newTokens=[];for(let j=0;j<tokens.length;j++){let token=this._queue[i](tokens[j]);if(token){newTokens.push(token)}}tokens=newTokens}return tokens}toJSON(){let serialized={tokenizers:[]};if(this._splitter!==defaultSplitter){serialized.splitter=this._splitter[this._symbol]}for(let i=0;i<this._queue.length;i++){serialized.tokenizers.push(this._queue[i][this._symbol])}return serialized}static fromJSONObject(serialized,funcTok=undefined){let tkz=new Tokenizer;if(funcTok!==undefined&&funcTok instanceof Tokenizer){if(serialized.splitter!==undefined){let splitter=funcTok.getSplitter();if(serialized.splitter!==splitter[0]){throw Error("Splitter function not found.")}tkz.setSplitter(splitter[0],splitter[1])}for(let i=0;i<serialized.tokenizers.length;i++){if(!funcTok.has(serialized.tokenizers[i])){throw Error("Tokenizer function not found.")}let labelFunc=funcTok.get(serialized.tokenizers[i]);tkz.add(labelFunc[0],labelFunc[1])}}else{if(serialized.splitter!==undefined){if(funcTok.splitters[serialized.splitter]===undefined){throw Error("Splitter function not found.")}tkz.setSplitter(serialized.splitter,funcTok.splitters[serialized.splitter])}for(let i=0;i<serialized.tokenizers.length;i++){if(funcTok.tokenizers[serialized.tokenizers[i]]===undefined){throw Error("Tokenizer function not found.")}tkz.add(serialized.tokenizers[i],funcTok.tokenizers[serialized.tokenizers[i]])}}return tkz}_getPosition(labelFunc){if(labelFunc instanceof Function){return this._queue.indexOf(labelFunc)}else{for(let i=0;i<this._queue.length;i++){if(this._queue[i][this._symbol]===labelFunc){return i}}}return-1}_addFunction(label,func,pos){if(label===""){throw Error("Label cannot be empty.")}func[this._symbol]=label;this._queue.splice(pos,0,func)}}__webpack_exports__["a"]=Tokenizer},function(module,__webpack_exports__,__webpack_require__){"use strict";class BaseQuery{constructor(type,data={}){this._data=data;this._data.type=type}boost(value){if(value<0){throw TypeError("Boost must be a positive number.")}this._data.boost=value;return this}build(){return this._data}}class TermQuery extends BaseQuery{constructor(field,term,data={}){super("term",data);this._data.field=field;this._data.value=term}}class TermsQuery extends BaseQuery{constructor(field,terms,data={}){super("terms",data);this._data.field=field;this._data.value=terms}}class WildcardQuery extends BaseQuery{constructor(field,wildcard,data={}){super("wildcard",data);this._data.field=field;this._data.value=wildcard}enableScoring(enable){this._data.enable_scoring=enable;return this}}class FuzzyQuery extends BaseQuery{constructor(field,fuzzy,data={}){super("fuzzy",data);this._data.field=field;this._data.value=fuzzy}fuzziness(fuzziness){if(fuzziness!=="AUTO"&&fuzziness<0){throw TypeError("Fuzziness must be a positive number or AUTO.")}this._data.fuzziness=fuzziness;return this}prefixLength(prefixLength){if(prefixLength<0){throw TypeError("Prefix length must be a positive number.")}this._data.prefix_length=prefixLength;return this}extended(extended){this._data.extended=extended;return this}}class PrefixQuery extends BaseQuery{constructor(field,prefix,data={}){super("prefix",data);this._data.field=field;this._data.value=prefix}enableScoring(enable){this._data.enable_scoring=enable;return this}}class ExistsQuery extends BaseQuery{constructor(field,data={}){super("exists",data);this._data.field=field}}class MatchQuery extends BaseQuery{constructor(field,query,data={}){super("match",data);this._data.field=field;this._data.value=query}minimumShouldMatch(minShouldMatch){if(this._data.operator!==undefined&&this._data.operator==="and"){throw SyntaxError('Match query with "and" operator does not support minimum should match.')}this._data.minimum_should_match=minShouldMatch;return this}operator(op){if(op!=="and"&&op!=="or"){throw SyntaxError("Unknown operator.")}this._data.operator=op;if(this._data.minimum_should_match!==undefined&&this._data.operator==="and"){throw SyntaxError('Match query with "and" operator does not support minimum should match.')}return this}fuzziness(fuzziness){if(fuzziness!=="AUTO"&&fuzziness<0){throw TypeError("Fuzziness must be a positive number or AUTO.")}this._data.fuzziness=fuzziness;return this}prefixLength(prefixLength){if(prefixLength<0){throw TypeError("Prefix length must be a positive number.")}this._data.prefix_length=prefixLength;return this}extended(extended){this._data.extended=extended;return this}}class MatchAllQuery extends BaseQuery{constructor(data={}){super("match_all",data)}}class ArrayQuery extends BaseQuery{constructor(callbackName,callback,data={}){super("array",data);this._data.values=[];this._callbackName=callbackName;this[callbackName]=callback;this._prepare=((queryType,...args)=>{const data={};const query=new queryType(...args,data);this._data.values.push(data);query.bool=this.bool;query.constantScore=this.constantScore;query.term=this.term;query.terms=this.terms;query.wildcard=this.wildcard;query.fuzzy=this.fuzzy;query.match=this.match;query.matchAll=this.matchAll;query.prefix=this.prefix;query.exists=this.exists;query._prepare=this._prepare;query[this._callbackName]=this[this._callbackName];return query})}bool(){return this._prepare(BoolQuery)}constantScore(){return this._prepare(ConstantScoreQuery)}term(field,term){return this._prepare(TermQuery,field,term)}terms(field,terms){return this._prepare(TermsQuery,field,terms)}wildcard(field,wildcard){return this._prepare(WildcardQuery,field,wildcard)}fuzzy(field,fuzzy){return this._prepare(FuzzyQuery,field,fuzzy)}match(field,query){return this._prepare(MatchQuery,field,query)}matchAll(){return this._prepare(MatchAllQuery)}prefix(field,prefix){return this._prepare(PrefixQuery,field,prefix)}exists(field){return this._prepare(ExistsQuery,field)}}class ConstantScoreQuery extends BaseQuery{constructor(data={}){super("constant_score",data)}beginFilter(){this._data.filter={};return new ArrayQuery("endFilter",()=>{return this},this._data.filter)}}class BoolQuery extends BaseQuery{constructor(data={}){super("bool",data)}beginMust(){this._data.must={};return new ArrayQuery("endMust",()=>{return this},this._data.must)}beginFilter(){this._data.filter={};return new ArrayQuery("endFilter",()=>{return this},this._data.filter)}beginShould(){this._data.should={};return new ArrayQuery("endShould",()=>{return this},this._data.should)}beginNot(){this._data.not={};return new ArrayQuery("endNot",()=>{return this},this._data.not)}minimumShouldMatch(minShouldMatch){this._data.minimum_should_match=minShouldMatch;return this}}class QueryBuilder{constructor(){this._data={query:{}};this.useBM25()}enableFinalScoring(enable){this._data.final_scoring=enable;return this}useBM25(k1=1.2,b=.75){if(k1<0){throw TypeError("BM25s k1 must be a positive number.")}if(b<0||b>1){throw TypeError("BM25s b must be a number between 0 and 1 inclusive.")}this._data.scoring={type:"BM25",k1:k1,b:b};return this}bool(){return this._prepare(BoolQuery)}constantScore(){return this._prepare(ConstantScoreQuery)}term(field,term){return this._prepare(TermQuery,field,term)}terms(field,terms){return this._prepare(TermsQuery,field,terms)}wildcard(field,wildcard){return this._prepare(WildcardQuery,field,wildcard)}fuzzy(field,fuzzy){return this._prepare(FuzzyQuery,field,fuzzy)}match(field,query){return this._prepare(MatchQuery,field,query)}matchAll(){return this._prepare(MatchAllQuery)}prefix(field,prefix){return this._prepare(PrefixQuery,field,prefix)}exists(field){return this._prepare(ExistsQuery,field)}_prepare(queryType,...args){this._child=new queryType(...args,this._data.query);this._child.build=(()=>{return this._data});return this._child}}__webpack_exports__["a"]=QueryBuilder},function(module,__webpack_exports__,__webpack_require__){"use strict";class Long{constructor(low=0,high=0){this.low=low;this.high=high}shiftRight(numBits){if((numBits&=63)===0)return this;else if(numBits<32)return new Long(this.low>>>numBits|this.high<<32-numBits,this.high>>numBits);else return new Long(this.high>>numBits-32,this.high>=0?0:-1)}shiftLeft(numBits){if((numBits&=63)===0)return this;else if(numBits<32)return new Long(this.low<<numBits,this.high<<numBits|this.low>>>32-numBits);else return new Long(0,this.low<<numBits-32)}and(other){return new Long(this.low&other.low,this.high&other.high)}toInt(){return this.low}}__webpack_exports__["a"]=Long},function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:true});var __WEBPACK_IMPORTED_MODULE_0__full_text_search__=__webpack_require__(5);var __WEBPACK_IMPORTED_MODULE_1__tokenizer__=__webpack_require__(1);__webpack_require__.d(__webpack_exports__,"Tokenizer",function(){return __WEBPACK_IMPORTED_MODULE_1__tokenizer__["a"]});var __WEBPACK_IMPORTED_MODULE_2__query_builder__=__webpack_require__(2);__webpack_require__.d(__webpack_exports__,"QueryBuilder",function(){return __WEBPACK_IMPORTED_MODULE_2__query_builder__["a"]});var __WEBPACK_IMPORTED_MODULE_3__inverted_index__=__webpack_require__(0);__webpack_require__.d(__webpack_exports__,"InvertedIndex",function(){return __WEBPACK_IMPORTED_MODULE_3__inverted_index__["a"]});__webpack_require__.d(__webpack_exports__,"FullTextSearch",function(){return __WEBPACK_IMPORTED_MODULE_0__full_text_search__["a"]});__webpack_exports__["default"]=__WEBPACK_IMPORTED_MODULE_0__full_text_search__["a"]},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__inverted_index__=__webpack_require__(0);var __WEBPACK_IMPORTED_MODULE_1__index_searcher__=__webpack_require__(6);var __WEBPACK_IMPORTED_MODULE_2__common_plugin__=__webpack_require__(13);class FullTextSearch{constructor(fields=[],id="$loki"){this._invIdxs={};for(let i=0;i<fields.length;i++){let field=fields[i];this._invIdxs[field.name]=new __WEBPACK_IMPORTED_MODULE_0__inverted_index__["a"](field)}this._id=id;this._docs=new Set;this._idxSearcher=new __WEBPACK_IMPORTED_MODULE_1__index_searcher__["a"](this._invIdxs,this._docs)}static register(){__WEBPACK_IMPORTED_MODULE_2__common_plugin__["a"]["FullTextSearch"]=FullTextSearch}addDocument(doc,id=doc[this._id]){let fieldNames=Object.keys(doc);for(let i=0,fieldName;i<fieldNames.length,fieldName=fieldNames[i];i++){if(this._invIdxs[fieldName]!==undefined){this._invIdxs[fieldName].insert(doc[fieldName],id)}}this._docs.add(id);this.setDirty()}removeDocument(doc,id=doc[this._id]){let fieldNames=Object.keys(this._invIdxs);for(let i=0;i<fieldNames.length;i++){this._invIdxs[fieldNames[i]].remove(id)}this._docs.delete(id);this.setDirty()}updateDocument(doc,id=doc[this._id]){this.removeDocument(doc,id);this.addDocument(doc,id)}clear(){for(let id of this._docs){this.removeDocument(null,id)}}search(query){return this._idxSearcher.search(query)}toJSON(){let serialized={};let fieldNames=Object.keys(this._invIdxs);for(let i=0,fieldName;i<fieldNames.length,fieldName=fieldNames[i];i++){serialized[fieldName]=this._invIdxs[fieldName].toJSON()}return serialized}static fromJSONObject(serialized,tokenizers=[]){let fts=new FullTextSearch;let fieldNames=Object.keys(serialized);for(let i=0,fieldName;i<fieldNames.length,fieldName=fieldNames[i];i++){fts._invIdxs[fieldName]=__WEBPACK_IMPORTED_MODULE_0__inverted_index__["a"].fromJSONObject(serialized[fieldName],tokenizers[fieldName])}return fts}setDirty(){this._idxSearcher.setDirty()}}__webpack_exports__["a"]=FullTextSearch;var _unused_webpack_default_export=FullTextSearch},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__scorer__=__webpack_require__(7);var __WEBPACK_IMPORTED_MODULE_1__inverted_index__=__webpack_require__(0);var __WEBPACK_IMPORTED_MODULE_2__query_builder__=__webpack_require__(2);var __WEBPACK_IMPORTED_MODULE_3__fuzzy_RunAutomaton__=__webpack_require__(8);var __WEBPACK_IMPORTED_MODULE_4__fuzzy_LevenshteinAutomata__=__webpack_require__(9);class IndexSearcher{constructor(invIdxs,docs){this._invIdxs=invIdxs;this._docs=docs;this._scorer=new __WEBPACK_IMPORTED_MODULE_0__scorer__["a"](this._invIdxs)}search(query){let docResults=this._recursive(query.query,true);let finalScoring=query.final_scoring!==undefined?query.final_scoring:true;if(finalScoring){return this._scorer.finalScore(query,docResults)}return docResults}setDirty(){this._scorer.setDirty()}_recursive(query,doScoring){let docResults={};let boost=query.boost!==undefined?query.boost:1;let fieldName=query.field!==undefined?query.field:null;let enableScoring=query.enable_scoring!==undefined?query.enable_scoring:false;let root=null;let tokenizer=null;if(this._invIdxs[fieldName]!==undefined){root=this._invIdxs[fieldName].root;tokenizer=this._invIdxs[fieldName].tokenizer}switch(query.type){case"bool":{docResults=null;if(query.must!==undefined){docResults=this._getUnique(query.must.values,doScoring,docResults)}if(query.filter!==undefined){docResults=this._getUnique(query.filter.values,false,docResults)}if(query.should!==undefined){let shouldDocs=this._getAll(query.should.values,doScoring);let empty=false;if(docResults===null){docResults={};empty=true}let msm=1;if(query.minimum_should_match!==undefined){msm=query.minimum_should_match;let shouldLength=query.should.values.length;if(msm<=-1){msm=shouldLength+msm}else if(msm<0){msm=shouldLength-Math.floor(shouldLength*-msm)}else if(msm<1){msm=Math.floor(shouldLength*msm)}}let docs=Object.keys(shouldDocs);for(let i=0,docId;i<docs.length,docId=docs[i];i++){if(shouldDocs[docId].length>=msm){if(docResults[docId]!==undefined){docResults[docId].push(...shouldDocs[docId])}else if(empty){docResults[docId]=shouldDocs[docId]}else{delete docResults[docId]}}}}if(query.not!==undefined){let notDocs=this._getAll(query.not.values,false);let docs=Object.keys(notDocs);for(let i=0,docId;i<docs.length,docId=docs[i];i++){if(docResults[docId]!==undefined){delete docResults[docId]}}}break}case"term":{const cps=Object(__WEBPACK_IMPORTED_MODULE_1__inverted_index__["b"])(query.value);let termIdx=__WEBPACK_IMPORTED_MODULE_1__inverted_index__["a"].getTermIndex(cps,root);this._scorer.prepare(fieldName,boost,termIdx,doScoring,docResults,cps);break}case"terms":{for(let i=0;i<query.value.length;i++){const cps=Object(__WEBPACK_IMPORTED_MODULE_1__inverted_index__["b"])(query.value[i]);let termIdx=__WEBPACK_IMPORTED_MODULE_1__inverted_index__["a"].getTermIndex(cps,root);this._scorer.prepare(fieldName,boost,termIdx,doScoring,docResults,cps)}break}case"fuzzy":{let f=fuzzySearch(query,root);break}case"wildcard":{let w=wildcardSearch(query,root);for(let i=0;i<w.length;i++){this._scorer.prepare(fieldName,boost,w[i].index,doScoring&&enableScoring,docResults,w[i].term)}break}case"match_all":{for(let docId of this._docs){this._scorer.scoreConstant(boost,docId,docResults)}break}case"constant_score":{let tmpDocResults=this._getAll(query.filter.values,false);let docs=Object.keys(tmpDocResults);for(let i=0;i<docs.length;i++){this._scorer.scoreConstant(boost,docs[i],docResults)}break}case"prefix":{const cps=Object(__WEBPACK_IMPORTED_MODULE_1__inverted_index__["b"])(query.value);let termIdx=__WEBPACK_IMPORTED_MODULE_1__inverted_index__["a"].getTermIndex(cps,root);if(termIdx!==null){const termIdxs=__WEBPACK_IMPORTED_MODULE_1__inverted_index__["a"].extendTermIndex(termIdx);for(let i=0;i<termIdxs.length;i++){this._scorer.prepare(fieldName,boost,termIdxs[i].index,doScoring&&enableScoring,docResults,[...cps,...termIdxs[i].term])}}break}case"exists":{if(root!==null){let docs=Object.keys(this._invIdxs[fieldName].documentStore);for(let i=0;i<docs.length;i++){this._scorer.scoreConstant(boost,docs[i],docResults)}}break}case"match":{let terms=tokenizer.tokenize(query.value);let operator=query.operator!==undefined?query.operator:"or";let tmpQuery=(new __WEBPACK_IMPORTED_MODULE_2__query_builder__["a"]).bool();if(operator==="or"){if(query.minimum_should_match!==undefined){tmpQuery=tmpQuery.minimumShouldMatch(query.minimum_should_match)}tmpQuery=tmpQuery.beginShould()}else{tmpQuery=tmpQuery.beginMust()}tmpQuery=tmpQuery.boost(boost);if(query.fuzziness!==undefined){let prefixLength=query.prefix_length!==undefined?query.prefix_length:2;let extended=query.extended!==undefined?query.extended:false;for(let i=0;i<terms.length;i++){tmpQuery=tmpQuery.fuzzy(fieldName,terms[i]).fuzziness(query.fuzziness).prefixLength(prefixLength).extended(extended)}}else{for(let i=0;i<terms.length;i++){tmpQuery=tmpQuery.term(fieldName,terms[i])}}if(operator==="or"){tmpQuery=tmpQuery.endShould()}else{tmpQuery=tmpQuery.endMust()}docResults=this._recursive(tmpQuery.build().query,doScoring);break}default:break}return docResults}_getUnique(values,doScoring,docResults){if(values.length===0){return docResults}for(let i=0;i<values.length;i++){let currDocs=this._recursive(values[i],doScoring);if(docResults===null){docResults=this._recursive(values[0],doScoring);continue}let docs=Object.keys(docResults);for(let j=0,docId;j<docs.length,docId=docs[j];j++){if(currDocs[docId]===undefined){delete docResults[docId]}else{docResults[docId].push(...currDocs[docId])}}}return docResults}_getAll(values,doScoring){let docResults={};for(let i=0;i<values.length;i++){let currDocs=this._recursive(values[i],doScoring);let docs=Object.keys(currDocs);for(let j=0,docId;j<docs.length,docId=docs[j];j++){if(docResults[docId]===undefined){docResults[docId]=currDocs[docId]}else{docResults[docId].push(...currDocs[docId])}}}return docResults}}__webpack_exports__["a"]=IndexSearcher;function levenshteinDistance(a,b){if(a.length===0)return b.length;if(b.length===0)return a.length;let tmp;let i;let j;let prev;let val;if(a.length>b.length){tmp=a;a=b;b=tmp}const row=Array(a.length+1);for(i=0;i<=a.length;i++){row[i]=i}for(i=1;i<=b.length;i++){prev=i;for(j=1;j<=a.length;j++){if(b[i-1]===a[j-1]){val=row[j-1]}else{val=Math.min(row[j-1]+1,Math.min(prev+1,row[j]+1));if(i>1&&j>1&&b[i-2]===a[j-1]&&a[j-2]===b[i-1]){val=Math.min(val,row[j-1]-(a[j-1]===b[i-1]?1:0))}}row[j-1]=prev;prev=val}row[a.length]=prev}return row[a.length]}function fuzzySearch(query,root){let res=[];function calculateDistance(state,a,n){let ed=0;state=a.step(state,0);if(state!==-1){ed++;state=a.step(state,0);if(state!==-1){ed++}}return n-ed}function run(a,root){let edit_distance=1;function rec(state,key,idx,r){r[r.length-1]=key;state=a.step(state,key);if(state===-1){return}if(a.isAccept(state)&&idx.df!==undefined){res.push({index:root,term:String.fromCodePoint(...r)})}r.push(0);for(const child of idx){rec(state,child[0],child[1],r)}r.pop()}let r=[0];for(const child of root){rec(0,child[0],child[1],r)}}let la=new __WEBPACK_IMPORTED_MODULE_4__fuzzy_LevenshteinAutomata__["a"](Object(__WEBPACK_IMPORTED_MODULE_1__inverted_index__["b"])(query.value));let tr=la.run();let ra=new __WEBPACK_IMPORTED_MODULE_3__fuzzy_RunAutomaton__["a"](tr);run(ra,root);throw res}function fuzzySearch2(query,root){let value=query.value;let fuzziness=query.fuzziness!==undefined?query.fuzziness:"AUTO";if(fuzziness==="AUTO"){if(value.length<=2){fuzziness=0}else if(value.length<=5){fuzziness=1}else{fuzziness=2}}let prefixLength=query.prefix_length!==undefined?query.prefix_length:2;let extended=query.extended!==undefined?query.extended:false;let start=root;let pre=value.slice(0,prefixLength);let fuzzy=value;if(prefixLength!==0){start=__WEBPACK_IMPORTED_MODULE_1__inverted_index__["a"].getTermIndex(pre,start);fuzzy=fuzzy.slice(prefixLength)}if(start===null){return[]}if(fuzzy.length===0){return[{term:"",index:start,boost:1}]}let extend_fuzzy=1e10;let similarTokens=[];let stack=[start];let treeStack=[""];do{let index=stack.pop();let treeTerms=treeStack.pop();if(extended){if(treeTerms.length===fuzzy.length){extend_fuzzy=levenshteinDistance(fuzzy,treeTerms)}else{extend_fuzzy=extend_fuzzy<=fuzziness&&treeTerms.length>=fuzzy.length?extend_fuzzy:1e10}}if(index.df!==undefined){let matched=false;if(Math.abs(fuzzy.length-treeTerms.length)<=fuzziness){const distance=levenshteinDistance(fuzzy,treeTerms);if(distance<=fuzziness){let term=pre+treeTerms;let boost=1-distance/Math.min(term.length,value.length);similarTokens.push({term:term,index:index,boost:boost});matched=true}}if(extend_fuzzy<=fuzziness&&!matched){let term=pre+treeTerms;let boost=1-(extend_fuzzy+treeTerms.length-fuzzy.length)/Math.min(term.length,value.length);similarTokens.push({term:term,index:index,boost:boost})}}if(treeTerms.length-fuzzy.length<=fuzziness||extend_fuzzy<=fuzziness){let keys=Object.keys(index);for(let i=0;i<keys.length;i++){if(keys[i].length===1){stack.push(index[keys[i]]);treeStack.push(treeTerms+keys[i])}}}}while(stack.length!==0);return similarTokens}function wildcardSearch(query,root){let wildcard=Object(__WEBPACK_IMPORTED_MODULE_1__inverted_index__["b"])(query.value);let result=[];function recursive(index,idx=0,term=[],escaped=false){if(index===null){return}if(idx===wildcard.length){if(index.df!==undefined){result.push({index:index,term:term.slice()})}return}if(!escaped&&wildcard[idx]===92){recursive(index,idx+1,term,true)}else if(!escaped&&wildcard[idx]===63){for(const child of index){recursive(child[1],idx+1,term+child[0])}}else if(!escaped&&wildcard[idx]===42){if(idx+1===wildcard.length){const all=__WEBPACK_IMPORTED_MODULE_1__inverted_index__["a"].extendTermIndex(index);for(let i=0;i<all.length;i++){recursive(all[i].index,idx+1,[...term,...all[i].term])}}else{recursive(index,idx+1,term,false);const indices=[{index:index,term:[]}];do{const index=indices.pop();for(const child of index.index){recursive(child[1],idx+1,[...term,...index.term,child[0]]);indices.push({index:child[1],term:[...index.term,child[0]]})}}while(indices.length!==0)}}else{recursive(__WEBPACK_IMPORTED_MODULE_1__inverted_index__["a"].getTermIndex([wildcard[idx]],index),idx+1,[...term,wildcard[idx]])}}recursive(root);return result}},function(module,__webpack_exports__,__webpack_require__){"use strict";class Scorer{constructor(invIdxs){this._cache={};this._invIdxs=invIdxs}setDirty(){this._cache={}}prepare(fieldName,boost,termIdx,doScoring,docResults={},term=null){if(termIdx===null||termIdx.dc===undefined){return null}const idf=this._idf(fieldName,termIdx.df);const docIds=Object.keys(termIdx.dc);for(let j=0;j<docIds.length;j++){const docId=docIds[j];if(docResults[docId]===undefined){docResults[docId]=[]}if(doScoring){const tf=termIdx.dc[docId];docResults[docId].push({type:"BM25",tf:tf,idf:idf,boost:boost,fieldName:fieldName,term:term})}else{docResults[docId]=[{type:"constant",value:1,boost:boost,fieldName:fieldName}]}}return docResults}scoreConstant(boost,docId,docResults={}){if(docResults[docId]===undefined){docResults[docId]=[]}docResults[docId].push({type:"constant",value:1,boost:boost});return docResults}finalScore(query,docResults={}){const result={};const k1=query.scoring.k1;const b=query.scoring.b;const docs=Object.keys(docResults);for(let i=0,docId;i<docs.length,docId=docs[i];i++){let docScore=0;for(let j=0;j<docResults[docId].length;j++){const docResult=docResults[docId][j];let res=0;switch(docResult.type){case"BM25":{const tf=docResult.tf;const fieldLength=Scorer._calculateFieldLength(this._invIdxs[docResult.fieldName].documentStore[docId].fieldLength);const avgFieldLength=this._avgFieldLength(docResult.fieldName);const tfNorm=tf*(k1+1)/(tf+k1*(1-b+b*(fieldLength/avgFieldLength)));res=docResult.idf*tfNorm*docResult.boost;break}case"constant":res=docResult.value*docResult.boost;break}docScore+=res}result[docId]=docScore}return result}static _calculateFieldLength(fieldLength){return fieldLength}_getCache(fieldName){if(this._cache[fieldName]===undefined){const avgFieldLength=this._invIdxs[fieldName].totalFieldLength/this._invIdxs[fieldName].documentCount;this._cache[fieldName]={idfs:{},avgFieldLength:avgFieldLength}}return this._cache[fieldName]}_idf(fieldName,docFreq){const cache=this._getCache(fieldName);if(cache.idfs[docFreq]!==undefined){return cache.idfs[docFreq]}return cache.idfs[docFreq]=Math.log(1+(this._invIdxs[fieldName].documentCount-docFreq+.5)/(docFreq+.5))}_avgFieldLength(fieldName){return this._getCache(fieldName).avgFieldLength}}__webpack_exports__["a"]=Scorer},function(module,__webpack_exports__,__webpack_require__){"use strict";class RunAutomaton{constructor(a){this.automaton=a;this.points=a.getStartPoints();this.size=a.getNumStates();this.accept=[];this.transitions=[];for(let n=0;n<this.size;n++){this.accept[n]=a.isAccept(n);for(let c=0;c<this.points.length;c++){let dest=a.step(n,this.points[c]);if(dest!==-1&&dest>=this.size){}this.transitions[n*this.points.length+c]=dest}}this.alphabetSize=256;this.classmap=new Array(Math.min(256,this.alphabetSize));let i=0;for(let j=0;j<this.classmap.length;j++){if(i+1<this.points.length&&j===this.points[i+1]){i++}this.classmap[j]=i}}getCharClass(c){let a=0;let b=this.points.length;while(b-a>1){let d=a+b>>>1;if(this.points[d]>c)b=d;else if(this.points[d]<c)a=d;else return d}return a}step(state,c){if(c>=this.classmap.length){return this.transitions[state*this.points.length+this.getCharClass(c)]}else{return this.transitions[state*this.points.length+this.classmap[c]]}}isAccept(state){return this.accept[state]}}__webpack_exports__["a"]=RunAutomaton},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__Automata__=__webpack_require__(10);var __WEBPACK_IMPORTED_MODULE_1__Lev1TParametricDescription__=__webpack_require__(11);class LevenshteinAutomata{constructor(input,alphaMax=__WEBPACK_IMPORTED_MODULE_0__Automata__["b"]){this.word=input;this.alphabet=Array.from(this.word).sort((a,b)=>a-b);this.numRanges=0;this.rangeLower=new Array(this.alphabet.length+2);this.rangeUpper=new Array(this.alphabet.length+2);let lower=0;for(let i=0;i<this.alphabet.length;i++){const higher=this.alphabet[i];if(higher>lower){this.rangeLower[this.numRanges]=lower;this.rangeUpper[this.numRanges]=higher-1;this.numRanges++}lower=higher+1}if(lower<=alphaMax){this.rangeLower[this.numRanges]=lower;this.rangeUpper[this.numRanges]=alphaMax;this.numRanges++}this.description=new __WEBPACK_IMPORTED_MODULE_1__Lev1TParametricDescription__["a"](input.length)}getVector(x,pos,end){let vector=0;for(let i=pos;i<end;i++){vector<<=1;if(this.word[i]===x){vector|=1}}return vector}run(){let automat=new __WEBPACK_IMPORTED_MODULE_0__Automata__["a"];const n=1;const range=2*n+1;const numStates=this.description.size();automat.createState();const stateOffset=0;for(let i=1;i<numStates;i++){let state=automat.createState();automat.setAccept(state,this.description.isAccept(i))}for(let k=0;k<numStates;k++){const xpos=this.description.getPosition(k);if(xpos<0){continue}const end=xpos+Math.min(this.word.length-xpos,range);for(let x=0;x<this.alphabet.length;x++){const ch=this.alphabet[x];const cvec=this.getVector(ch,xpos,end);const dest=this.description.transition(k,xpos,cvec);if(dest>=0){automat.addTransition(stateOffset+k,stateOffset+dest,ch,ch)}}const dest=this.description.transition(k,xpos,0);if(dest>=0){for(let r=0;r<this.numRanges;r++){automat.addTransition(stateOffset+k,stateOffset+dest,this.rangeLower[r],this.rangeUpper[r])}}}if(!automat.deterministic){}automat.finishState();return automat}}__webpack_exports__["a"]=LevenshteinAutomata},function(module,__webpack_exports__,__webpack_require__){"use strict";class Transition{constructor(dest,min,max){this.dest=dest;this.min=min;this.max=max}}const MIN_CODE_POINT=0;const MAX_CODE_POINT=1114111;__webpack_exports__["b"]=MAX_CODE_POINT;class Automaton{constructor(){this.transitions=[];this.transitions=[];this._isAccept=new Set;this.nextState=0;this.currState=-1;this.deterministic=true;this.trans={}}isAccept(n){return this._isAccept.has(n)}createState(){return this.nextState++}setAccept(state,accept){if(accept){this._isAccept.add(state)}else{this._isAccept.delete(state)}}finishState(){if(this.currState!==-1){this.finishCurrentState();this.currState=-1}}finishCurrentState(){const destMinMax=(a,b)=>{if(a.dest<b.dest){return-1}else if(a.dest>b.dest){return 1}if(a.min<b.min){return-1}else if(a.min>b.min){return 1}if(a.max<b.max){return-1}else if(a.max>b.max){return 1}return 0};const minMaxDest=(a,b)=>{if(a.min<b.min){return-1}else if(a.min>b.min){return 1}if(a.max<b.max){return-1}else if(a.max>b.max){return 1}if(a.dest<b.dest){return-1}else if(a.dest>b.dest){return 1}return 0};this.transitions.sort(destMinMax);let offset=0;let upto=0;let p=new Transition(-1,-1,-1);for(let i=0,len=this.transitions.length;i<len;i++){let t=this.transitions[i];if(p.dest===t.dest){if(t.min<=p.max+1){if(t.max>p.max){p.max=t.max}}else{if(p.dest!==-1){this.transitions[offset+upto].dest=p.dest;this.transitions[offset+upto].min=p.min;this.transitions[offset+upto].max=p.max;upto++}p.min=t.min;p.max=t.max}}else{if(p.dest!==-1){this.transitions[offset+upto].dest=p.dest;this.transitions[offset+upto].min=p.min;this.transitions[offset+upto].max=p.max;upto++}p.dest=t.dest;p.min=t.min;p.max=t.max}}if(p.dest!==-1){this.transitions[offset+upto].dest=p.dest;this.transitions[offset+upto].min=p.min;this.transitions[offset+upto].max=p.max;upto++}this.transitions=this.transitions.slice(0,upto);this.transitions.sort(minMaxDest);if(this.deterministic&&upto>1){let lastMax=this.transitions[0].max;for(let i=1;i<upto;i++){let min=this.transitions[i].min;if(min<=lastMax){this.deterministic=false;break}lastMax=this.transitions[i].max}}this.trans[this.currState]=this.transitions.slice();this.transitions=[]}getStartPoints(){let pointset=new Set;pointset.add(MIN_CODE_POINT);const states=Object.keys(this.trans);for(let i=0;i<states.length;i++){let trans=this.trans[states[i]];for(let j=0;j<trans.length;j++){let tran=trans[j];pointset.add(tran.min);if(tran.max<MAX_CODE_POINT){pointset.add(tran.max+1)}}}return Array.from(pointset).sort((a,b)=>a-b)}step(state,label){let trans=this.trans[state];if(trans){for(let i=0;i<trans.length;i++){let tran=trans[i];if(tran.min<=label&&label<=tran.max){return tran.dest}}}return-1}getNumStates(){return this.nextState}addTransition(source,dest,min,max){if(this.currState!==source){if(this.currState!==-1){this.finishCurrentState()}this.currState=source}this.transitions.push(new Transition(dest,min,max))}}__webpack_exports__["a"]=Automaton},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__Long__=__webpack_require__(3);var __WEBPACK_IMPORTED_MODULE_1__ParametricDescription__=__webpack_require__(12);const toStates0=[new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](2)];const offsetIncrs0=[new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](0)];const toStates1=[new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](2627)];const offsetIncrs1=[new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](56)];const toStates2=[new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](2182348803,877873428),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](109)];const offsetIncrs2=[new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](1436680192,21845)];const toStates3=[new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](2416705539,559024212),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](1161073005,1531779490),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](55860)];const offsetIncrs3=[new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](553385984,1431678474),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](1431655765)];class Lev1TParametricDescription extends __WEBPACK_IMPORTED_MODULE_1__ParametricDescription__["a"]{constructor(w){super(w,1,[0,1,0,-1,-1,-1])}transition(absState,position,vector){let state=Math.floor(absState/(this.w+1));let offset=absState%(this.w+1);if(position===this.w){if(state<2){const loc=vector*2+state;offset+=this.unpack(offsetIncrs0,loc,1);state=this.unpack(toStates0,loc,2)-1}}else if(position===this.w-1){if(state<3){const loc=vector*3+state;offset+=this.unpack(offsetIncrs1,loc,1);state=this.unpack(toStates1,loc,2)-1}}else if(position===this.w-2){if(state<6){const loc=vector*6+state;offset+=this.unpack(offsetIncrs2,loc,2);state=this.unpack(toStates2,loc,3)-1}}else{if(state<6){const loc=vector*6+state;offset+=this.unpack(offsetIncrs3,loc,2);state=this.unpack(toStates3,loc,3)-1}}if(state===-1){return-1}else{return state*(this.w+1)+offset}}}__webpack_exports__["a"]=Lev1TParametricDescription},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__Long__=__webpack_require__(3);const MASKS=[new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](1),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](3),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](7),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](15),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](31),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](63),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](127),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](255),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](511),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](1023),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](2047),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](4095),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](8191),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](16383),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](32767),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](65535),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](15,8191),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](15,16383),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](15,32767),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](15,65535),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](255,8191),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](255,16383),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](255,32767),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](255,65535),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](4095,8191),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](4095,16383),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](4095,32767),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](4095,65535),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](65535,8191),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](65535,16383),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](65535,32767),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](65535,65535),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](1048575,8191),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](1048575,16383),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](1048575,32767),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](1048575,65535),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](16777215,8191),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](16777215,16383),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](16777215,32767),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](16777215,65535),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](268435455,8191),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](268435455,16383),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](268435455,32767),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](268435455,65535),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](4294967295,8191),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](4294967295,16383),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](4294967295,32767),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](4294967295,65535),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](68719476735,8191),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](68719476735,16383),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](68719476735,32767),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](68719476735,65535),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](0xffffffffff,8191),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](0xffffffffff,16383),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](0xffffffffff,32767),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](0xffffffffff,65535),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](0xfffffffffff,8191),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](0xfffffffffff,16383),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](0xfffffffffff,32767),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](0xfffffffffff,65535),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](0xffffffffffff,8191),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](0xffffffffffff,16383),new __WEBPACK_IMPORTED_MODULE_0__Long__["a"](0xffffffffffff,32767)];class ParametricDescription{constructor(w,n,minErrors){this.w=w;this.n=n;this.minErrors=minErrors}size(){return this.minErrors.length*(this.w+1)}isAccept(absState){let state=Math.floor(absState/(this.w+1));let offset=absState%(this.w+1);return this.w-offset+this.minErrors[state]<=this.n}getPosition(absState){return absState%(this.w+1)}unpack(data,index,bitsPerValue){const bitLoc=bitsPerValue*index;const dataLoc=bitLoc>>6;const bitStart=bitLoc&63;if(bitStart+bitsPerValue<=64){return data[dataLoc].shiftRight(bitStart).and(MASKS[bitsPerValue-1]).toInt()}else{const part=64-bitStart;return data[dataLoc].shiftRight(bitStart).and(MASKS[part-1]).toInt()+data[1+dataLoc].and(MASKS[bitsPerValue-part-1]).shiftLeft(part).toInt()}}}__webpack_exports__["a"]=ParametricDescription},function(module,__webpack_exports__,__webpack_require__){"use strict";(function(global){function getGlobal(){let glob;(function(global){glob=global})(global!==undefined&&global||this);return glob}function create(){const global=getGlobal();const sym=Symbol.for("LOKI");if(global[sym]===undefined){global[sym]={}}return global[sym]}const PLUGINS=create();__webpack_exports__["a"]=PLUGINS}).call(__webpack_exports__,__webpack_require__(14))},function(module,exports){var g;g=function(){return this}();try{g=g||Function("return this")()||(1,eval)("this")}catch(e){if(typeof window==="object")g=window}module.exports=g}])});