{"version":3,"sources":["webpack://@lokidb/indexed-storage/webpack/universalModuleDefinition","webpack://@lokidb/indexed-storage/webpack/bootstrap","webpack://@lokidb/indexed-storage/./packages/common/plugin.ts","webpack://@lokidb/indexed-storage/./packages/indexed-storage/src/indexed_storage.ts","webpack://@lokidb/indexed-storage/./packages/indexed-storage/src/index.ts","webpack://@lokidb/indexed-storage/(webpack)/buildin/global.js"],"names":[],"mappings":"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","file":"lokidb.indexed-storage.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"@lokidb/indexed-storage\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"@lokidb/indexed-storage\"] = factory();\n\telse\n\t\troot[\"@lokidb/indexed-storage\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","function getGlobal(): any {\n  let glob;\n  (function (global) {\n    glob = global;\n  })(global !== undefined && global || this);\n  return glob;\n}\n\n\nfunction create(): void {\n  const global = getGlobal();\n  const sym = Symbol.for(\"LOKI\") as any;\n  if (global[sym] === undefined) {\n    global[sym] = {\n    };\n  }\n  return global[sym];\n}\n\n/**\n * @hidden\n */\nexport const PLUGINS = create();\n","import { PLUGINS } from \"../../common/plugin\";\nimport { StorageAdapter } from \"../../common/types\";\n\n/*\n Loki IndexedDb Adapter (need to include this script to use it)\n\n Console Usage can be used for management/diagnostic, here are a few examples :\n adapter.getDatabaseList(); // with no callback passed, this method will log results to console\n adapter.saveDatabase(\"UserDatabase\", JSON.stringify(myDb));\n adapter.loadDatabase(\"UserDatabase\"); // will log the serialized db to console\n adapter.deleteDatabase(\"UserDatabase\");\n\n Should usercallback be still used?\n */\n\n/**\n * @hidden\n */\ndeclare type ANY = any;\n\n/**\n * Loki persistence adapter class for indexedDb.\n *     This class fulfills abstract adapter interface which can be applied to other storage methods.\n *     Utilizes the included LokiCatalog app/key/value database for actual database persistence.\n *     IndexedDb storage is provided per-domain, so we implement app/key/value database to\n *     allow separate contexts for separate apps within a domain.\n */\nexport class IndexedStorage implements StorageAdapter {\n  private _appname: string;\n  private catalog: any;\n\n  /**\n   * Registers the indexed storage as plugin.\n   */\n  static register(): void {\n    PLUGINS[\"IndexedStorage\"] = IndexedStorage;\n  }\n\n  /**\n   * Deregisters the indexed storage as plugin.\n   */\n  static deregister(): void {\n    delete PLUGINS[\"IndexedStorage\"];\n  }\n\n  /**\n   * @param {string} [appname=loki] - Application name context can be used to distinguish subdomains, \"loki\" by default\n   */\n  constructor(appname: string = \"loki\") {\n    this._appname = appname;\n\n    // keep reference to catalog class for base AKV operations\n    this.catalog = null;\n  }\n\n  /**\n   * Retrieves a serialized db string from the catalog.\n   *\n   * @example\n   * // LOAD\n   * var idbAdapter = new LokiIndexedAdapter(\"finance\");\n   * var db = new loki(\"test\", { adapter: idbAdapter });\n   *   db.base(function(result) {\n\t *   console.log(\"done\");\n\t * });\n   *\n   * @param {string} dbname - the name of the database to retrieve.\n   * @returns {Promise} a Promise that resolves after the database was loaded\n   */\n  loadDatabase(dbname: string) {\n    const appName = this._appname;\n    const adapter = this;\n\n    // lazy open/create db reference so dont -need- callback in constructor\n    if (this.catalog === null || this.catalog.db === null) {\n      return new Promise((resolve) => {\n        adapter.catalog = new LokiCatalog((cat: LokiCatalog) => {\n          adapter.catalog = cat;\n          resolve(adapter.loadDatabase(dbname));\n        });\n      });\n    }\n    // lookup up db string in AKV db\n    return new Promise((resolve) => {\n      this.catalog.getAppKey(appName, dbname, (result: ANY) => {\n        if (result.id === 0) {\n          resolve();\n          return;\n        }\n        resolve(result.val);\n      });\n    });\n  }\n\n  /**\n   * Saves a serialized db to the catalog.\n   *\n   * @example\n   * // SAVE : will save App/Key/Val as \"finance\"/\"test\"/{serializedDb}\n   * let idbAdapter = new LokiIndexedAdapter(\"finance\");\n   * let db = new loki(\"test\", { adapter: idbAdapter });\n   * let coll = db.addCollection(\"testColl\");\n   * coll.insert({test: \"val\"});\n   * db.saveDatabase();  // could pass callback if needed for async complete\n   *\n   * @param {string} dbname - the name to give the serialized database within the catalog.\n   * @param {string} dbstring - the serialized db string to save.\n   * @returns {Promise} a Promise that resolves after the database was persisted\n   */\n  saveDatabase(dbname: string, dbstring: string): Promise<void> {\n    const appName = this._appname;\n    const adapter = this;\n\n    let resolve: ANY;\n    let reject: ANY;\n    const result = new Promise<void>((res: ANY, rej: ANY) => {\n      resolve = res;\n      reject = rej;\n    });\n\n    function saveCallback(result: ANY) {\n      if (result && result.success === true) {\n        resolve();\n      } else {\n        reject(new Error(\"Error saving database\"));\n      }\n    }\n\n    // lazy open/create db reference so dont -need- callback in constructor\n    if (this.catalog === null || this.catalog.db === null) {\n      this.catalog = new LokiCatalog((cat: LokiCatalog) => {\n        adapter.catalog = cat;\n\n        // now that catalog has been initialized, set (add/update) the AKV entry\n        cat.setAppKey(appName, dbname, dbstring, saveCallback);\n      });\n\n      return result;\n    }\n\n    // set (add/update) entry to AKV database\n    this.catalog.setAppKey(appName, dbname, dbstring, saveCallback);\n\n    return result;\n  }\n\n  /**\n   * Deletes a serialized db from the catalog.\n   *\n   * @example\n   * // DELETE DATABASE\n   * // delete \"finance\"/\"test\" value from catalog\n   * idbAdapter.deleteDatabase(\"test\", function {\n\t *   // database deleted\n\t * });\n   *\n   * @param {string} dbname - the name of the database to delete from the catalog.\n   * @returns {Promise} a Promise that resolves after the database was deleted\n   */\n  deleteDatabase(dbname: string): Promise<void> {\n    const appName = this._appname;\n    const adapter = this;\n\n    // lazy open/create db reference and pass callback ahead\n    if (this.catalog === null || this.catalog.db === null) {\n      return new Promise((resolve) => {\n        adapter.catalog = new LokiCatalog((cat: LokiCatalog) => {\n          adapter.catalog = cat;\n\n          resolve(adapter.deleteDatabase(dbname));\n        });\n      });\n    }\n\n    // catalog was already initialized, so just lookup object and delete by id\n    return new Promise((resolve) => {\n      this.catalog.getAppKey(appName, dbname, (result: ANY) => {\n        const id = result.id;\n\n        if (id !== 0) {\n          adapter.catalog.deleteAppKey(id);\n        }\n\n        resolve();\n      });\n    });\n  }\n\n  /**\n   * Removes all database partitions and pages with the base filename passed in.\n   * This utility method does not (yet) guarantee async deletions will be completed before returning\n   *\n   * @param {string} dbname - the base filename which container, partitions, or pages are derived\n   */\n  deleteDatabasePartitions(dbname: string) {\n    this.getDatabaseList((result: string[]) => {\n      result.forEach((str) => {\n        if (str.startsWith(dbname)) {\n          this.deleteDatabase(str);\n        }\n      });\n    });\n  }\n\n  /**\n   * Retrieves object array of catalog entries for current app.\n   *\n   * @example\n   * idbAdapter.getDatabaseList(function(result) {\n\t *   // result is array of string names for that appcontext (\"finance\")\n\t *   result.forEach(function(str) {\n\t *     console.log(str);\n\t *   });\n\t * });\n   *\n   * @param {function} callback - should accept array of database names in the catalog for current app.\n   */\n  getDatabaseList(callback: (names: string[]) => void) {\n    const appName = this._appname;\n    const adapter = this;\n\n    // lazy open/create db reference so dont -need- callback in constructor\n    if (this.catalog === null || this.catalog.db === null) {\n      this.catalog = new LokiCatalog((cat: LokiCatalog) => {\n        adapter.catalog = cat;\n\n        adapter.getDatabaseList(callback);\n      });\n\n      return;\n    }\n\n    // catalog already initialized\n    // get all keys for current appName, and transpose results so just string array\n    this.catalog.getAppKeys(appName, (results: ANY) => {\n      const names = [];\n\n      for (let idx = 0; idx < results.length; idx++) {\n        names.push(results[idx].key);\n      }\n\n      if (typeof(callback) === \"function\") {\n        callback(names);\n      } else {\n        names.forEach(() => {\n          // console.log(obj);\n        });\n      }\n    });\n  }\n\n  /**\n   * Allows retrieval of list of all keys in catalog along with size\n   * @param {function} callback - (Optional) callback to accept result array.\n   */\n  public getCatalogSummary(callback: (entry: Entry[]) => void) {\n    const adapter = this;\n\n    // lazy open/create db reference\n    if (this.catalog === null || this.catalog.db === null) {\n      this.catalog = new LokiCatalog((cat: LokiCatalog) => {\n        adapter.catalog = cat;\n\n        adapter.getCatalogSummary(callback);\n      });\n\n      return;\n    }\n\n    // catalog already initialized\n    // get all keys for current appName, and transpose results so just string array\n    this.catalog.getAllKeys((results: ANY) => {\n      const entries = [];\n      let obj;\n      let size;\n      let oapp;\n      let okey;\n      let oval;\n\n      for (let idx = 0; idx < results.length; idx++) {\n        obj = results[idx];\n        oapp = obj.app || \"\";\n        okey = obj.key || \"\";\n        oval = obj.val || \"\";\n\n        // app and key are composited into an appkey column so we will mult by 2\n        size = oapp.length * 2 + okey.length * 2 + oval.length + 1;\n\n        entries.push({\n          \"app\": obj.app,\n          \"key\": obj.key,\n          \"size\": size\n        });\n      }\n\n      if (typeof(callback) === \"function\") {\n        callback(entries);\n      } else {\n        entries.forEach(() => {\n          // console.log(obj);\n        });\n      }\n    });\n  }\n}\n\nexport interface Entry {\n  app: string;\n  key: string;\n  size: number;\n}\n\n/**\n * LokiCatalog - underlying App/Key/Value catalog persistence\n *    This non-interface class implements the actual persistence.\n *    Used by the LokiIndexedStorage class.\n */\nclass LokiCatalog {\n  public db: ANY;\n\n  constructor(callback: any) {\n    this.db = null;\n    this.initializeLokiCatalog(callback);\n  }\n\n  initializeLokiCatalog(callback: any) {\n    const openRequest = indexedDB.open(\"LokiCatalog\", 1);\n    const cat = this;\n\n    // If database doesn't exist yet or its version is lower than our version specified above (2nd param in line above)\n    openRequest.onupgradeneeded = (e: ANY) => {\n      const thisDB = e.target.result;\n      if (thisDB.objectStoreNames.contains(\"LokiAKV\")) {\n        thisDB.deleteObjectStore(\"LokiAKV\");\n      }\n\n      if (!thisDB.objectStoreNames.contains(\"LokiAKV\")) {\n        const objectStore = thisDB.createObjectStore(\"LokiAKV\", {\n          keyPath: \"id\",\n          autoIncrement: true\n        });\n        objectStore.createIndex(\"app\", \"app\", {\n          unique: false\n        });\n        objectStore.createIndex(\"key\", \"key\", {\n          unique: false\n        });\n        // hack to simulate composite key since overhead is low (main size should be in val field)\n        // user (me) required to duplicate the app and key into comma delimited appkey field off object\n        // This will allow retrieving single record with that composite key as well as\n        // still supporting opening cursors on app or key alone\n        objectStore.createIndex(\"appkey\", \"appkey\", {\n          unique: true\n        });\n      }\n    };\n\n    openRequest.onsuccess = (e: ANY) => {\n      cat.db = e.target.result;\n\n      if (typeof(callback) === \"function\")\n        callback(cat);\n    };\n\n    openRequest.onerror = (e: ANY) => {\n      throw e;\n    };\n  }\n\n  getAppKey(app: string, key: string, callback: any) {\n    const transaction = this.db.transaction([\"LokiAKV\"], \"readonly\");\n    const store = transaction.objectStore(\"LokiAKV\");\n    const index = store.index(\"appkey\");\n    const appkey = app + \",\" + key;\n    const request = index.get(appkey);\n\n    request.onsuccess = (((usercallback) => (e: ANY) => {\n      let lres = e.target.result;\n\n      if (lres === null || lres === undefined) {\n        lres = {\n          id: 0,\n          success: false\n        };\n      }\n\n      if (typeof(usercallback) === \"function\") {\n        usercallback(lres);\n      } else {\n        // console.log(lres);\n      }\n    }))(callback);\n\n    request.onerror = (((usercallback) => (e: ANY) => {\n      if (typeof(usercallback) === \"function\") {\n        usercallback({\n          id: 0,\n          success: false\n        });\n      } else {\n        throw e;\n      }\n    }))(callback);\n  }\n\n  getAppKeyById(id: string, callback: ANY, data: ANY) {\n    const transaction = this.db.transaction([\"LokiAKV\"], \"readonly\");\n    const store = transaction.objectStore(\"LokiAKV\");\n    const request = store.get(id);\n\n    request.onsuccess = (((data, usercallback) => (e: ANY) => {\n      if (typeof(usercallback) === \"function\") {\n        usercallback(e.target.result, data);\n      } else {\n        // console.log(e.target.result);\n      }\n    }))(data, callback);\n  }\n\n  setAppKey(app: string, key: string, val: string, callback: any) {\n    const transaction = this.db.transaction([\"LokiAKV\"], \"readwrite\");\n    const store = transaction.objectStore(\"LokiAKV\");\n    const index = store.index(\"appkey\");\n    const appkey = app + \",\" + key;\n    const request = index.get(appkey);\n\n    // first try to retrieve an existing object by that key\n    // need to do this because to update an object you need to have id in object, otherwise it will append id with new autocounter and clash the unique index appkey\n    request.onsuccess = (e: ANY) => {\n      let res = e.target.result;\n\n      if (res === null || res === undefined) {\n        res = {\n          app,\n          key,\n          appkey: app + \",\" + key,\n          val\n        };\n      } else {\n        res.val = val;\n      }\n\n      const requestPut = store.put(res);\n\n      requestPut.onerror = (((usercallback) => () => {\n        if (typeof(usercallback) === \"function\") {\n          usercallback({\n            success: false\n          });\n        } else {\n          // console.error(\"LokiCatalog.setAppKey (set) onerror\");\n          // console.error(request.error);\n        }\n      }))(callback);\n\n      requestPut.onsuccess = (((usercallback) => () => {\n        if (typeof(usercallback) === \"function\") {\n          usercallback({\n            success: true\n          });\n        }\n      }))(callback);\n    };\n\n    request.onerror = (((usercallback) => () => {\n      if (typeof(usercallback) === \"function\") {\n        usercallback({\n          success: false\n        });\n      } else {\n        // console.error(\"LokiCatalog.setAppKey (get) onerror\");\n        // console.error(request.error);\n      }\n    }))(callback);\n  }\n\n  deleteAppKey(id: string, callback: any) {\n    const transaction = this.db.transaction([\"LokiAKV\"], \"readwrite\");\n    const store = transaction.objectStore(\"LokiAKV\");\n    const request = store.delete(id);\n\n    request.onsuccess = (((usercallback) => () => {\n      if (typeof(usercallback) === \"function\") usercallback({\n        success: true\n      });\n    }))(callback);\n\n    request.onerror = (((usercallback) => () => {\n      if (typeof(usercallback) === \"function\") {\n        usercallback(false);\n      } else {\n        // console.error(\"LokiCatalog.deleteAppKey raised onerror\");\n        // console.error(request.error);\n      }\n    }))(callback);\n  }\n\n  getAppKeys(app: string, callback: any) {\n    const transaction = this.db.transaction([\"LokiAKV\"], \"readonly\");\n    const store = transaction.objectStore(\"LokiAKV\");\n    const index = store.index(\"app\");\n\n    // We want cursor to all values matching our (single) app param\n    const singleKeyRange = IDBKeyRange.only(app);\n\n    // To use one of the key ranges, pass it in as the first argument of openCursor()/openKeyCursor()\n    const cursor = index.openCursor(singleKeyRange);\n\n    // cursor internally, pushing results into this.data[] and return\n    // this.data[] when done (similar to service)\n    const localdata: any[] = [];\n\n    cursor.onsuccess = (((data, callback) => (e: ANY) => {\n      const cursor = e.target.result;\n      if (cursor) {\n        const currObject = cursor.value;\n\n        data.push(currObject);\n\n        cursor.continue();\n      } else {\n        if (typeof(callback) === \"function\") {\n          callback(data);\n        } else {\n          // console.log(data);\n        }\n      }\n    }))(localdata, callback);\n\n    cursor.onerror = (((usercallback) => () => {\n      if (typeof(usercallback) === \"function\") {\n        usercallback(null);\n      } else {\n        // console.error(\"LokiCatalog.getAppKeys raised onerror\");\n        // console.error(e);\n      }\n    }))(callback);\n\n  }\n\n  // Hide \"cursoring\" and return array of { id: id, key: key }\n  getAllKeys(callback: any) {\n    const transaction = this.db.transaction([\"LokiAKV\"], \"readonly\");\n    const store = transaction.objectStore(\"LokiAKV\");\n    const cursor = store.openCursor();\n\n    const localdata: ANY[] = [];\n\n    cursor.onsuccess = (((data, callback) => (e: ANY) => {\n      const cursor = e.target.result;\n      if (cursor) {\n        const currObject = cursor.value;\n\n        data.push(currObject);\n\n        cursor.continue();\n      } else {\n        if (typeof(callback) === \"function\") {\n          callback(data);\n        } else {\n          // console.log(data);\n        }\n      }\n    }))(localdata, callback);\n\n    cursor.onerror = (((usercallback) => () => {\n      if (typeof(usercallback) === \"function\") usercallback(null);\n    }))(callback);\n  }\n}\n\nexport default IndexedStorage;\n","import { IndexedStorage } from \"./indexed_storage\";\n\nexport {IndexedStorage};\nexport default IndexedStorage;\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || Function(\"return this\")() || (1, eval)(\"this\");\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n"],"sourceRoot":""}